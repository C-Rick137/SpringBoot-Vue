/* empty css             *//* empty css                   *//* empty css                  *//* empty css                 *//* empty css                   *//* empty css               *//* empty css               *//* empty css               *//* empty css                */import{r as q,K as I,c as _,a as p,b as a,w as n,L as i,M as b,A as M,B as O,O as R,C as $,P as F,o as y,d,i as J,u as V,Q as j,R as K,S as L,T as Q,N as Z,Z as G}from"./index-C0GlKI4r.js";import{r as u}from"./request-ClfIVEhE.js";const H={class:"card",style:{"margin-bottom":"5px"}},W={class:"card",style:{"margin-bottom":"5px"}},X={class:"card",style:{"margin-bottom":"5px"}},Y=["src"],ee={style:{"margin-top":"15px"}},te={class:"dialog-footer"},ce={__name:"Admin",setup(ae){const e=q({name:null,tableData:[],pageNum:1,pageSize:10,total:0,formVisible:!1,form:{},ids:[],rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}]}}),g=I(),r=()=>{u.get("/admin/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name}}).then(o=>{e.tableData=o.data.list,e.total=o.data.total})};r();const C=()=>{e.name=null,r()},v=()=>{e.formVisible=!0,e.form={}},x=()=>{g.value.validate(o=>{o&&(e.form.id?k():h())})},h=()=>{u.post("/admin/add",e.form).then(o=>{o.code==="200"?(e.formVisible=!1,i.success("操作成功"),r()):i.error(o.msg)})},k=()=>{u.put("/admin/update",e.form).then(o=>{o.code==="200"?(e.formVisible=!1,i.success("操作成功"),r()):i.error(o.msg)})},w=o=>{e.form=JSON.parse(JSON.stringify(o)),e.formVisible=!0},S=o=>{b.confirm("删除数据后无法恢复，您确认删除吗？","删除确认",{type:"warning"}).then(()=>{u.delete("/admin/deleteById/"+o).then(t=>{t.code==="200"?(e.formVisible=!1,i.success("操作成功"),r()):i.error(t.msg)})}).catch()},E=o=>{e.ids=o.map(t=>t.id)},N=()=>{if(e.ids.length===0){i.warning("请选择数据");return}b.confirm("删除数据后无法恢复，您确认删除吗？","删除确认",{type:"warning"}).then(()=>{u.delete("/admin/deleteBatch",{data:e.ids}).then(o=>{o.code==="200"?(e.formVisible=!1,i.success("操作成功"),r()):i.error(o.msg)})}).catch()},z=o=>{e.form.avatar=o.data};return(o,t)=>{const f=M,s=O,m=L,B=R,U=$,c=Q,A=Z,D=G,P=F;return y(),_("div",null,[p("div",H,[a(f,{modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.name=l),placeholder:"请输入名称查询","prefix-icon":"Search",style:{width:"240px","margin-right":"10px"}},null,8,["modelValue"]),a(s,{type:"primary",onClick:r},{default:n(()=>t[7]||(t[7]=[d("查 询")])),_:1}),a(s,{type:"warning",onClick:C},{default:n(()=>t[8]||(t[8]=[d("重 置")])),_:1})]),p("div",W,[a(s,{type:"primary",onClick:v},{default:n(()=>t[9]||(t[9]=[d("新 增")])),_:1}),a(s,{type:"danger",onClick:N},{default:n(()=>t[10]||(t[10]=[d("批量删除")])),_:1})]),p("div",X,[a(B,{data:e.tableData,stripe:"",onSelectionChange:E},{default:n(()=>[a(m,{type:"selection",width:"55"}),a(m,{label:"账号",prop:"username"}),a(m,{label:"头像"},{default:n(l=>[l.row.avatar?(y(),_("img",{key:0,src:l.row.avatar,alt:"",style:{display:"block",width:"40px",height:"40px","border-radius":"50%"}},null,8,Y)):J("",!0)]),_:1}),a(m,{label:"名称",prop:"name"}),a(m,{label:"操作",width:"120"},{default:n(l=>[a(s,{icon:V(j),circle:"",type:"primary",onClick:T=>w(l.row)},null,8,["icon","onClick"]),a(s,{icon:V(K),circle:"",type:"danger",onClick:T=>S(l.row.id)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"]),p("div",ee,[a(U,{"current-page":e.pageNum,"onUpdate:currentPage":t[1]||(t[1]=l=>e.pageNum=l),"page-size":e.pageSize,"onUpdate:pageSize":t[2]||(t[2]=l=>e.pageSize=l),"page-sizes":[5,10,15,20],total:e.total,background:"",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:r,onCurrentChange:r},null,8,["current-page","page-size","total"])])]),a(P,{modelValue:e.formVisible,"onUpdate:modelValue":t[6]||(t[6]=l=>e.formVisible=l),"destroy-on-close":"",title:"管理员信息",width:"500"},{footer:n(()=>[p("div",te,[a(s,{onClick:t[5]||(t[5]=l=>e.formVisible=!1)},{default:n(()=>t[12]||(t[12]=[d("取 消")])),_:1}),a(s,{type:"primary",onClick:x},{default:n(()=>t[13]||(t[13]=[d("保 存")])),_:1})])]),default:n(()=>[a(D,{ref_key:"formRef",ref:g,model:e.form,rules:e.rules,"label-width":"80px",style:{"padding-right":"40px","padding-top":"20px"}},{default:n(()=>[a(c,{label:"账号",prop:"username"},{default:n(()=>[a(f,{modelValue:e.form.username,"onUpdate:modelValue":t[3]||(t[3]=l=>e.form.username=l),disabled:e.form.id,autocomplete:"off",placeholder:"请输入账号"},null,8,["modelValue","disabled"])]),_:1}),a(c,{label:"头像"},{default:n(()=>[a(A,{"on-success":z,action:"http://localhost:9090/files/upload","list-type":"picture"},{default:n(()=>[a(s,{type:"primary"},{default:n(()=>t[11]||(t[11]=[d("上传头像")])),_:1})]),_:1})]),_:1}),a(c,{label:"名称",prop:"name"},{default:n(()=>[a(f,{modelValue:e.form.name,"onUpdate:modelValue":t[4]||(t[4]=l=>e.form.name=l),autocomplete:"off",placeholder:"请输入名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}};export{ce as default};
